{"ds": {"vsitu": {"name": "vid_situ", "video_frms_tdir": "./vidsitu_data/vsitu_frames/", "video_trimmed_dir": "./vidsitu_data/vsitu_video_trimmed_dir", "split_files_dir": "./vidsitu_data/vidsitu_annotations/split_files", "split_files_lb": {"train": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_train_lb.json", "valid": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_valid_lb.json", "test_verb": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testvb_lb.json", "test_srl": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testsrl_lb.json", "test_evrel": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testevrel_lb.json"}, "vinfo_files_lb": {"train": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_train_lb.json", "valid": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_valid_lb.json", "test_verb": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testvb_lb.json", "test_srl": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testsrl_lb.json", "test_evrel": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testevrel_lb.json"}, "vsitu_ann_files_lb": {"train": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_train_lb.json", "valid": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_valid_lb.json", "test_verb": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testvb_lb.json", "test_srl": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testsrl_lb.json", "test_evrel": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testevrel_lb.json"}, "vocab_files": {"verb_id_vocab": "./vidsitu_data/vsitu_vocab/verb_id_vocab.pkl", "vb_arg_vocab": "./vidsitu_data/vsitu_meta/vsitu_vocab/vb_arg_vocab.pkl", "new_gpt2_vb_arg_vocab": "./vidsitu_data/vsitu_vocab/bpe_with_seps_vb_arg_vocab.pkl"}, "vsitu_frm_feats": "./vidsitu_data/vsitu_vid_feats/", "vsit_frm_feats_dir": "./vidsitu_data/vsitu_vid_feats/i3d_nln_kpret_ep10_best_recall", "vsit_clip_frm_feats_dir": "./vidsitu_data/clip_feat_vit-b32", "arg_names": {"vb": "Vb", "ag0": "Arg0", "ag1": "Arg1", "ag2": "Arg2", "ag3": "Arg3", "ag4": "Arg4", "ascn": "AScn", "aloc": "ALoc", "aprp": "APrp", "agol": "AGol", "adir": "ADir", "amnr": "AMnr"}, "num_ev": 5, "evrel_trimmed": true}, "trn_shuffle": true, "val_set_type": "lb"}, "task_type": "vb", "expm": {"exp_name": "vsitu_fin", "run_id": "2b4ea8394f3e4401a5f6d3bec8226350", "st_time": "2024-01-22 15:45:58"}, "mdl": {"sf_mdl_name": "slow_fast_nl_r50_8x8", "sf_mdl_cfg_file": "./configs/vsitu_mdl_cfgs/Kinetics_c2_SLOWFAST_8x8_R50.yaml", "load_sf_pretrained": false, "tx_dec_mdl_name": "transformer", "tx_dec_cfg_file": "./configs/vsitu_tx_cfgs/transformer.yaml", "gpt2_mdl_name": "gpt2-medium", "arg_mlp_hid_dim": 1024, "rob_mdl_name": "roberta-base", "mdl_name": "mlp_sfpret_txed_vbarg", "use_old_tok": false, "tx_enc_type": "old", "tx_dec_type": "txdec"}, "misc": {"tmp_path": "./tmp"}, "gen": {"beam_size": 1, "max_len_a": 0, "max_len_b": 200, "min_len": 0, "normalize_scores": true, "len_penalty": 1, "unk_penalty": 0, "temperature": 1.0, "no_repeat_ngram_size": 0}, "train": {"lr": 0.0001, "epochs": 20, "bs": 32, "nw": 4, "bsv": 16, "nwv": 4, "ns": 4, "resume": false, "resume_path": "", "load_opt": true, "load_normally": true, "strict_load": true, "use_reduce_lr_plateau": false, "verbose": false, "save_mdl_epochs": false, "sfbase_pret_path": "", "freeze_sfbase": false}, "log": {"deb_it": 2}, "debug_mode": false, "local_rank": 0, "do_dist": false, "do_dp": false, "num_gpus": 1, "only_val": false, "only_test": false, "test_dl_name": "test", "val_dl_name": "valid", "run_final_val": true, "overfit_batch": false, "DIST_BACKEND": "nccl", "SHARD_ID": 0, "uid": "test", "cmd": ["/home/dhruv/Projects/VidSitu/main_dist.py", "test", "--task_type", "vb"], "cmd_str": "/home/dhruv/Projects/VidSitu/main_dist.py test --task_type vb", "sf_mdl": {"AVA": {"ANNOTATION_DIR": "/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/", "BGR": false, "DETECTION_SCORE_THRESH": 0.9, "EXCLUSION_FILE": "ava_val_excluded_timestamps_v2.2.csv", "FRAME_DIR": "/mnt/fair-flash3-east/ava_trainval_frames.img/", "FRAME_LIST_DIR": "/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/", "FULL_TEST_ON_VAL": false, "GROUNDTRUTH_FILE": "ava_val_v2.2.csv", "IMG_PROC_BACKEND": "cv2", "LABEL_MAP_FILE": "ava_action_list_v2.2_for_activitynet_2019.pbtxt", "TEST_FORCE_FLIP": false, "TEST_LISTS": ["val.csv"], "TEST_PREDICT_BOX_LISTS": ["ava_val_predicted_boxes.csv"], "TRAIN_GT_BOX_LISTS": ["ava_train_v2.2.csv"], "TRAIN_LISTS": ["train.csv"], "TRAIN_PCA_EIGVAL": [0.225, 0.224, 0.229], "TRAIN_PCA_EIGVEC": [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]], "TRAIN_PCA_JITTER_ONLY": true, "TRAIN_PREDICT_BOX_LISTS": [], "TRAIN_USE_COLOR_AUGMENTATION": false}, "BENCHMARK": {"LOG_PERIOD": 100, "NUM_EPOCHS": 5, "SHUFFLE": true}, "BN": {"EPSILON": 1e-05, "MOMENTUM": 0.1, "NORM_TYPE": "batchnorm", "NUM_BATCHES_PRECISE": 200, "NUM_SPLITS": 1, "NUM_SYNC_DEVICES": 1, "USE_PRECISE_STATS": true, "WEIGHT_DECAY": 0.0}, "DATA": {"CROP_SIZE": 224, "DECODING_BACKEND": "pyav", "ENSEMBLE_METHOD": "sum", "INPUT_CHANNEL_NUM": [3, 3], "INV_UNIFORM_SAMPLE": false, "MEAN": [0.45, 0.45, 0.45], "MULTI_LABEL": false, "NUM_FRAMES": 32, "PATH_PREFIX": "", "PATH_TO_DATA_DIR": "", "RANDOM_FLIP": true, "REVERSE_INPUT_CHANNEL": false, "SAMPLING_RATE": 2, "STD": [0.225, 0.225, 0.225], "TARGET_FPS": 30, "TEST_CROP_SIZE": 256, "TRAIN_CROP_SIZE": 224, "TRAIN_JITTER_SCALES": [256, 320]}, "DATA_LOADER": {"ENABLE_MULTI_THREAD_DECODE": false, "NUM_WORKERS": 8, "PIN_MEMORY": true}, "DETECTION": {"ALIGNED": true, "ENABLE": false, "ROI_XFORM_RESOLUTION": 7, "SPATIAL_SCALE_FACTOR": 16}, "DIST_BACKEND": "nccl", "LOG_MODEL_INFO": true, "LOG_PERIOD": 10, "MODEL": {"ARCH": "mlp", "DROPOUT_RATE": 0.5, "FC_INIT_STD": 0.01, "HEAD_ACT": "softmax", "LOSS_FUNC": "cross_entropy", "MODEL_NAME": "SlowFast", "MULTI_PATHWAY_ARCH": ["slowfast"], "NUM_CLASSES": 400, "SINGLE_PATHWAY_ARCH": ["c2d", "i3d", "slow"]}, "MULTIGRID": {"BN_BASE_SIZE": 8, "DEFAULT_B": 0, "DEFAULT_S": 0, "DEFAULT_T": 0, "EPOCH_FACTOR": 1.5, "EVAL_FREQ": 3, "LONG_CYCLE": false, "LONG_CYCLE_FACTORS": [[0.25, 0.7071067811865476], [0.5, 0.7071067811865476], [0.5, 1], [1, 1]], "LONG_CYCLE_SAMPLING_RATE": 0, "SHORT_CYCLE": false, "SHORT_CYCLE_FACTORS": [0.5, 0.7071067811865476]}, "NONLOCAL": {"GROUP": [[1, 1], [1, 1], [1, 1], [1, 1]], "INSTANTIATION": "dot_product", "LOCATION": [[[], []], [[], []], [[], []], [[], []]], "POOL": [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]}, "NUM_GPUS": 8, "NUM_SHARDS": 1, "OUTPUT_DIR": ".", "RESNET": {"DEPTH": 50, "INPLACE_RELU": true, "NUM_BLOCK_TEMP_KERNEL": [[3, 3], [4, 4], [6, 6], [3, 3]], "NUM_GROUPS": 1, "SPATIAL_DILATIONS": [[1, 1], [1, 1], [1, 1], [1, 1]], "SPATIAL_STRIDES": [[1, 1], [2, 2], [2, 2], [2, 2]], "STRIDE_1X1": false, "TRANS_FUNC": "bottleneck_transform", "WIDTH_PER_GROUP": 64, "ZERO_INIT_FINAL_BN": true}, "RNG_SEED": 0, "SHARD_ID": 0, "SLOWFAST": {"ALPHA": 4, "BETA_INV": 8, "FUSION_CONV_CHANNEL_RATIO": 2, "FUSION_KERNEL_SZ": 7}, "SOLVER": {"BASE_LR": 0.1, "DAMPENING": 0.0, "GAMMA": 0.1, "LRS": [], "LR_POLICY": "cosine", "MAX_EPOCH": 196, "MOMENTUM": 0.9, "NESTEROV": true, "OPTIMIZING_METHOD": "sgd", "STEPS": [], "STEP_SIZE": 1, "WARMUP_EPOCHS": 34.0, "WARMUP_FACTOR": 0.1, "WARMUP_START_LR": 0.01, "WEIGHT_DECAY": 0.0001}, "TENSORBOARD": {"ENABLE": false, "LOG_DIR": ""}, "TEST": {"BATCH_SIZE": 64, "CHECKPOINT_FILE_PATH": "", "CHECKPOINT_TYPE": "pytorch", "DATASET": "kinetics", "ENABLE": true, "NUM_ENSEMBLE_VIEWS": 10, "NUM_SPATIAL_CROPS": 3}, "TRAIN": {"AUTO_RESUME": true, "BATCH_SIZE": 64, "CHECKPOINT_FILE_PATH": "./weights/SLOWFAST_CU_8x8_R50.pkl", "CHECKPOINT_INFLATE": false, "CHECKPOINT_PERIOD": 1, "CHECKPOINT_TYPE": "caffe2", "DATASET": "kinetics", "ENABLE": false, "EVAL_PERIOD": 10}, "mlp_hid_dim": 1024, "mlp_inp_dim": 512}, "tx_dec": {"activation_dropout": 0.0, "activation_fn": "relu", "adaptive_input": false, "adaptive_softmax_cutoff": null, "adaptive_softmax_dropout": 0, "attention_dropout": 0.0, "checkpoint_activations": false, "cross_self_attention": false, "decoder_attention_heads": 8, "decoder_embed_dim": 1024, "decoder_embed_path": null, "decoder_ffn_embed_dim": 2048, "decoder_input_dim": 512, "decoder_layerdrop": 0, "decoder_layers": 3, "decoder_layers_to_keep": null, "decoder_learned_pos": false, "decoder_normalize_before": false, "decoder_output_dim": 512, "dropout": 0.1, "encoder_attention_heads": 8, "encoder_embed_dim": 1024, "encoder_embed_path": null, "encoder_ffn_embed_dim": 2048, "encoder_layerdrop": 0, "encoder_layers": 3, "encoder_layers_to_keep": null, "encoder_learned_pos": false, "encoder_normalize_before": false, "layernorm_embedding": false, "max_source_positions": 1024, "max_target_positions": 1024, "merge_src_tgt_embed": false, "no_cross_attention": false, "no_scale_embedding": false, "no_token_positional_embeddings": false, "offload_activations": false, "quant_noise_pq": 0, "quant_noise_pq_block_size": 8, "quant_noise_scalar": 0, "share_all_embeddings": false, "share_decoder_input_output_embed": false, "tie_adaptive_weights": false}, "mdl_data_names": {"trn_data": "VsituDS", "val_data": "VsituDS", "trn_collator": "BatchCollator", "val_collator": "BatchCollator", "mdl_name": "VerbModel", "loss_name": "LossB", "eval_name": "EvalB", "opt_name": "Adam"}}

epochs  trn_loss  val_loss  val_Per_Ev_Top_1  val_Per_Ev_Top_5  val_recall_macro_1_th_9

{"ds": {"vsitu": {"name": "vid_situ", "video_frms_tdir": "./vidsitu_data/vsitu_frames/", "video_trimmed_dir": "./vidsitu_data/vsitu_video_trimmed_dir", "split_files_dir": "./vidsitu_data/vidsitu_annotations/split_files", "split_files_lb": {"train": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_train_lb.json", "valid": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_valid_lb.json", "test_verb": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testvb_lb.json", "test_srl": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testsrl_lb.json", "test_evrel": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testevrel_lb.json"}, "vinfo_files_lb": {"train": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_train_lb.json", "valid": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_valid_lb.json", "test_verb": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testvb_lb.json", "test_srl": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testsrl_lb.json", "test_evrel": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testevrel_lb.json"}, "vsitu_ann_files_lb": {"train": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_train_lb.json", "valid": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_valid_lb.json", "test_verb": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testvb_lb.json", "test_srl": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testsrl_lb.json", "test_evrel": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testevrel_lb.json"}, "vocab_files": {"verb_id_vocab": "./vidsitu_data/vsitu_vocab/verb_id_vocab.pkl", "vb_arg_vocab": "./vidsitu_data/vsitu_meta/vsitu_vocab/vb_arg_vocab.pkl", "new_gpt2_vb_arg_vocab": "./vidsitu_data/vsitu_vocab/bpe_with_seps_vb_arg_vocab.pkl"}, "vsitu_frm_feats": "./vidsitu_data/vsitu_vid_feats/", "vsit_frm_feats_dir": "./vidsitu_data/vsitu_vid_feats/i3d_nln_kpret_ep10_best_recall", "vsit_clip_frm_feats_dir": "./vidsitu_data/clip_feat_vit-b32", "arg_names": {"vb": "Vb", "ag0": "Arg0", "ag1": "Arg1", "ag2": "Arg2", "ag3": "Arg3", "ag4": "Arg4", "ascn": "AScn", "aloc": "ALoc", "aprp": "APrp", "agol": "AGol", "adir": "ADir", "amnr": "AMnr"}, "num_ev": 5, "evrel_trimmed": true}, "trn_shuffle": true, "val_set_type": "lb"}, "task_type": "vb", "expm": {"exp_name": "vsitu_fin", "run_id": "e4703b8bd12c41b39f85b1890d5125a1", "st_time": "2024-01-22 22:56:28"}, "mdl": {"sf_mdl_name": "slow_fast_nl_r50_8x8", "sf_mdl_cfg_file": "./configs/vsitu_mdl_cfgs/Kinetics_c2_SLOWFAST_8x8_R50.yaml", "load_sf_pretrained": false, "tx_dec_mdl_name": "transformer", "tx_dec_cfg_file": "./configs/vsitu_tx_cfgs/transformer.yaml", "gpt2_mdl_name": "gpt2-medium", "arg_mlp_hid_dim": 1024, "rob_mdl_name": "roberta-base", "mdl_name": "mlp_sfpret_txed_vbarg", "use_old_tok": false, "tx_enc_type": "old", "tx_dec_type": "txdec"}, "misc": {"tmp_path": "./tmp"}, "gen": {"beam_size": 1, "max_len_a": 0, "max_len_b": 200, "min_len": 0, "normalize_scores": true, "len_penalty": 1, "unk_penalty": 0, "temperature": 1.0, "no_repeat_ngram_size": 0}, "train": {"lr": 0.0001, "epochs": 20, "bs": 32, "nw": 4, "bsv": 16, "nwv": 4, "ns": 4, "resume": false, "resume_path": "", "load_opt": true, "load_normally": true, "strict_load": true, "use_reduce_lr_plateau": false, "verbose": false, "save_mdl_epochs": false, "sfbase_pret_path": "", "freeze_sfbase": false}, "log": {"deb_it": 2}, "debug_mode": false, "local_rank": 0, "do_dist": false, "do_dp": false, "num_gpus": 1, "only_val": false, "only_test": false, "test_dl_name": "test", "val_dl_name": "valid", "run_final_val": true, "overfit_batch": false, "DIST_BACKEND": "nccl", "SHARD_ID": 0, "uid": "test", "cmd": ["/home/dhruv/Projects/VidSitu/main_dist.py", "test", "--task_type", "vb"], "cmd_str": "/home/dhruv/Projects/VidSitu/main_dist.py test --task_type vb", "sf_mdl": {"AVA": {"ANNOTATION_DIR": "/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/", "BGR": false, "DETECTION_SCORE_THRESH": 0.9, "EXCLUSION_FILE": "ava_val_excluded_timestamps_v2.2.csv", "FRAME_DIR": "/mnt/fair-flash3-east/ava_trainval_frames.img/", "FRAME_LIST_DIR": "/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/", "FULL_TEST_ON_VAL": false, "GROUNDTRUTH_FILE": "ava_val_v2.2.csv", "IMG_PROC_BACKEND": "cv2", "LABEL_MAP_FILE": "ava_action_list_v2.2_for_activitynet_2019.pbtxt", "TEST_FORCE_FLIP": false, "TEST_LISTS": ["val.csv"], "TEST_PREDICT_BOX_LISTS": ["ava_val_predicted_boxes.csv"], "TRAIN_GT_BOX_LISTS": ["ava_train_v2.2.csv"], "TRAIN_LISTS": ["train.csv"], "TRAIN_PCA_EIGVAL": [0.225, 0.224, 0.229], "TRAIN_PCA_EIGVEC": [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]], "TRAIN_PCA_JITTER_ONLY": true, "TRAIN_PREDICT_BOX_LISTS": [], "TRAIN_USE_COLOR_AUGMENTATION": false}, "BENCHMARK": {"LOG_PERIOD": 100, "NUM_EPOCHS": 5, "SHUFFLE": true}, "BN": {"EPSILON": 1e-05, "MOMENTUM": 0.1, "NORM_TYPE": "batchnorm", "NUM_BATCHES_PRECISE": 200, "NUM_SPLITS": 1, "NUM_SYNC_DEVICES": 1, "USE_PRECISE_STATS": true, "WEIGHT_DECAY": 0.0}, "DATA": {"CROP_SIZE": 224, "DECODING_BACKEND": "pyav", "ENSEMBLE_METHOD": "sum", "INPUT_CHANNEL_NUM": [3, 3], "INV_UNIFORM_SAMPLE": false, "MEAN": [0.45, 0.45, 0.45], "MULTI_LABEL": false, "NUM_FRAMES": 32, "PATH_PREFIX": "", "PATH_TO_DATA_DIR": "", "RANDOM_FLIP": true, "REVERSE_INPUT_CHANNEL": false, "SAMPLING_RATE": 2, "STD": [0.225, 0.225, 0.225], "TARGET_FPS": 30, "TEST_CROP_SIZE": 256, "TRAIN_CROP_SIZE": 224, "TRAIN_JITTER_SCALES": [256, 320]}, "DATA_LOADER": {"ENABLE_MULTI_THREAD_DECODE": false, "NUM_WORKERS": 8, "PIN_MEMORY": true}, "DETECTION": {"ALIGNED": true, "ENABLE": false, "ROI_XFORM_RESOLUTION": 7, "SPATIAL_SCALE_FACTOR": 16}, "DIST_BACKEND": "nccl", "LOG_MODEL_INFO": true, "LOG_PERIOD": 10, "MODEL": {"ARCH": "mlp", "DROPOUT_RATE": 0.5, "FC_INIT_STD": 0.01, "HEAD_ACT": "softmax", "LOSS_FUNC": "cross_entropy", "MODEL_NAME": "SlowFast", "MULTI_PATHWAY_ARCH": ["slowfast"], "NUM_CLASSES": 400, "SINGLE_PATHWAY_ARCH": ["c2d", "i3d", "slow"]}, "MULTIGRID": {"BN_BASE_SIZE": 8, "DEFAULT_B": 0, "DEFAULT_S": 0, "DEFAULT_T": 0, "EPOCH_FACTOR": 1.5, "EVAL_FREQ": 3, "LONG_CYCLE": false, "LONG_CYCLE_FACTORS": [[0.25, 0.7071067811865476], [0.5, 0.7071067811865476], [0.5, 1], [1, 1]], "LONG_CYCLE_SAMPLING_RATE": 0, "SHORT_CYCLE": false, "SHORT_CYCLE_FACTORS": [0.5, 0.7071067811865476]}, "NONLOCAL": {"GROUP": [[1, 1], [1, 1], [1, 1], [1, 1]], "INSTANTIATION": "dot_product", "LOCATION": [[[], []], [[], []], [[], []], [[], []]], "POOL": [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]}, "NUM_GPUS": 8, "NUM_SHARDS": 1, "OUTPUT_DIR": ".", "RESNET": {"DEPTH": 50, "INPLACE_RELU": true, "NUM_BLOCK_TEMP_KERNEL": [[3, 3], [4, 4], [6, 6], [3, 3]], "NUM_GROUPS": 1, "SPATIAL_DILATIONS": [[1, 1], [1, 1], [1, 1], [1, 1]], "SPATIAL_STRIDES": [[1, 1], [2, 2], [2, 2], [2, 2]], "STRIDE_1X1": false, "TRANS_FUNC": "bottleneck_transform", "WIDTH_PER_GROUP": 64, "ZERO_INIT_FINAL_BN": true}, "RNG_SEED": 0, "SHARD_ID": 0, "SLOWFAST": {"ALPHA": 4, "BETA_INV": 8, "FUSION_CONV_CHANNEL_RATIO": 2, "FUSION_KERNEL_SZ": 7}, "SOLVER": {"BASE_LR": 0.1, "DAMPENING": 0.0, "GAMMA": 0.1, "LRS": [], "LR_POLICY": "cosine", "MAX_EPOCH": 196, "MOMENTUM": 0.9, "NESTEROV": true, "OPTIMIZING_METHOD": "sgd", "STEPS": [], "STEP_SIZE": 1, "WARMUP_EPOCHS": 34.0, "WARMUP_FACTOR": 0.1, "WARMUP_START_LR": 0.01, "WEIGHT_DECAY": 0.0001}, "TENSORBOARD": {"ENABLE": false, "LOG_DIR": ""}, "TEST": {"BATCH_SIZE": 64, "CHECKPOINT_FILE_PATH": "", "CHECKPOINT_TYPE": "pytorch", "DATASET": "kinetics", "ENABLE": true, "NUM_ENSEMBLE_VIEWS": 10, "NUM_SPATIAL_CROPS": 3}, "TRAIN": {"AUTO_RESUME": true, "BATCH_SIZE": 64, "CHECKPOINT_FILE_PATH": "./weights/SLOWFAST_CU_8x8_R50.pkl", "CHECKPOINT_INFLATE": false, "CHECKPOINT_PERIOD": 1, "CHECKPOINT_TYPE": "caffe2", "DATASET": "kinetics", "ENABLE": false, "EVAL_PERIOD": 10}, "mlp_hid_dim": 1024, "mlp_inp_dim": 512}, "tx_dec": {"activation_dropout": 0.0, "activation_fn": "relu", "adaptive_input": false, "adaptive_softmax_cutoff": null, "adaptive_softmax_dropout": 0, "attention_dropout": 0.0, "checkpoint_activations": false, "cross_self_attention": false, "decoder_attention_heads": 8, "decoder_embed_dim": 1024, "decoder_embed_path": null, "decoder_ffn_embed_dim": 2048, "decoder_input_dim": 512, "decoder_layerdrop": 0, "decoder_layers": 3, "decoder_layers_to_keep": null, "decoder_learned_pos": false, "decoder_normalize_before": false, "decoder_output_dim": 512, "dropout": 0.1, "encoder_attention_heads": 8, "encoder_embed_dim": 1024, "encoder_embed_path": null, "encoder_ffn_embed_dim": 2048, "encoder_layerdrop": 0, "encoder_layers": 3, "encoder_layers_to_keep": null, "encoder_learned_pos": false, "encoder_normalize_before": false, "layernorm_embedding": false, "max_source_positions": 1024, "max_target_positions": 1024, "merge_src_tgt_embed": false, "no_cross_attention": false, "no_scale_embedding": false, "no_token_positional_embeddings": false, "offload_activations": false, "quant_noise_pq": 0, "quant_noise_pq_block_size": 8, "quant_noise_scalar": 0, "share_all_embeddings": false, "share_decoder_input_output_embed": false, "tie_adaptive_weights": false}, "mdl_data_names": {"trn_data": "VsituDS", "val_data": "VsituDS", "trn_collator": "BatchCollator", "val_collator": "BatchCollator", "mdl_name": "VerbModel", "loss_name": "LossB", "eval_name": "EvalB", "opt_name": "Adam"}}

epochs  trn_loss  val_loss  val_Per_Ev_Top_1  val_Per_Ev_Top_5  val_recall_macro_1_th_9

1       5.1668    0.0000    0.3610            0.7549            0.0930                 
{"ds": {"vsitu": {"name": "vid_situ", "video_frms_tdir": "./vidsitu_data/vsitu_frames/", "video_trimmed_dir": "./vidsitu_data/vsitu_video_trimmed_dir", "split_files_dir": "./vidsitu_data/vidsitu_annotations/split_files", "split_files_lb": {"train": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_train_lb.json", "valid": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_valid_lb.json", "test_verb": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testvb_lb.json", "test_srl": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testsrl_lb.json", "test_evrel": "./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testevrel_lb.json"}, "vinfo_files_lb": {"train": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_train_lb.json", "valid": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_valid_lb.json", "test_verb": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testvb_lb.json", "test_srl": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testsrl_lb.json", "test_evrel": "./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testevrel_lb.json"}, "vsitu_ann_files_lb": {"train": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_train_lb.json", "valid": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_valid_lb.json", "test_verb": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testvb_lb.json", "test_srl": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testsrl_lb.json", "test_evrel": "./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testevrel_lb.json"}, "vocab_files": {"verb_id_vocab": "./vidsitu_data/vsitu_vocab/verb_id_vocab.pkl", "vb_arg_vocab": "./vidsitu_data/vsitu_meta/vsitu_vocab/vb_arg_vocab.pkl", "new_gpt2_vb_arg_vocab": "./vidsitu_data/vsitu_vocab/bpe_with_seps_vb_arg_vocab.pkl"}, "vsitu_frm_feats": "./vidsitu_data/vsitu_vid_feats/", "vsit_frm_feats_dir": "./vidsitu_data/vsitu_vid_feats/i3d_nln_kpret_ep10_best_recall", "vsit_clip_frm_feats_dir": "./vidsitu_data/clip_feat_vit-b32", "arg_names": {"vb": "Vb", "ag0": "Arg0", "ag1": "Arg1", "ag2": "Arg2", "ag3": "Arg3", "ag4": "Arg4", "ascn": "AScn", "aloc": "ALoc", "aprp": "APrp", "agol": "AGol", "adir": "ADir", "amnr": "AMnr"}, "num_ev": 5, "evrel_trimmed": true}, "trn_shuffle": true, "val_set_type": "lb"}, "task_type": "vb", "expm": {"exp_name": "vsitu_fin", "run_id": "9c4f02666ee04d7180f36d4e5350d781", "st_time": "2024-01-23 17:37:01"}, "mdl": {"sf_mdl_name": "slow_fast_nl_r50_8x8", "sf_mdl_cfg_file": "./configs/vsitu_mdl_cfgs/Kinetics_c2_SLOWFAST_8x8_R50.yaml", "load_sf_pretrained": false, "tx_dec_mdl_name": "transformer", "tx_dec_cfg_file": "./configs/vsitu_tx_cfgs/transformer.yaml", "gpt2_mdl_name": "gpt2-medium", "arg_mlp_hid_dim": 1024, "rob_mdl_name": "roberta-base", "mdl_name": "mlp_sfpret_txed_vbarg", "use_old_tok": false, "tx_enc_type": "old", "tx_dec_type": "txdec"}, "misc": {"tmp_path": "./tmp"}, "gen": {"beam_size": 1, "max_len_a": 0, "max_len_b": 200, "min_len": 0, "normalize_scores": true, "len_penalty": 1, "unk_penalty": 0, "temperature": 1.0, "no_repeat_ngram_size": 0}, "train": {"lr": 0.0001, "epochs": 20, "bs": 32, "nw": 4, "bsv": 16, "nwv": 4, "ns": 4, "resume": false, "resume_path": "", "load_opt": true, "load_normally": true, "strict_load": true, "use_reduce_lr_plateau": false, "verbose": false, "save_mdl_epochs": false, "sfbase_pret_path": "", "freeze_sfbase": false}, "log": {"deb_it": 2}, "debug_mode": false, "local_rank": 0, "do_dist": false, "do_dp": false, "num_gpus": 1, "only_val": false, "only_test": false, "test_dl_name": "test", "val_dl_name": "valid", "run_final_val": true, "overfit_batch": false, "DIST_BACKEND": "nccl", "SHARD_ID": 0, "uid": "test", "cmd": ["main_dist.py", "test", "--task_type", "vb"], "cmd_str": "main_dist.py test --task_type vb", "sf_mdl": {"AVA": {"ANNOTATION_DIR": "/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/", "BGR": false, "DETECTION_SCORE_THRESH": 0.9, "EXCLUSION_FILE": "ava_val_excluded_timestamps_v2.2.csv", "FRAME_DIR": "/mnt/fair-flash3-east/ava_trainval_frames.img/", "FRAME_LIST_DIR": "/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/", "FULL_TEST_ON_VAL": false, "GROUNDTRUTH_FILE": "ava_val_v2.2.csv", "IMG_PROC_BACKEND": "cv2", "LABEL_MAP_FILE": "ava_action_list_v2.2_for_activitynet_2019.pbtxt", "TEST_FORCE_FLIP": false, "TEST_LISTS": ["val.csv"], "TEST_PREDICT_BOX_LISTS": ["ava_val_predicted_boxes.csv"], "TRAIN_GT_BOX_LISTS": ["ava_train_v2.2.csv"], "TRAIN_LISTS": ["train.csv"], "TRAIN_PCA_EIGVAL": [0.225, 0.224, 0.229], "TRAIN_PCA_EIGVEC": [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]], "TRAIN_PCA_JITTER_ONLY": true, "TRAIN_PREDICT_BOX_LISTS": [], "TRAIN_USE_COLOR_AUGMENTATION": false}, "BENCHMARK": {"LOG_PERIOD": 100, "NUM_EPOCHS": 5, "SHUFFLE": true}, "BN": {"EPSILON": 1e-05, "MOMENTUM": 0.1, "NORM_TYPE": "batchnorm", "NUM_BATCHES_PRECISE": 200, "NUM_SPLITS": 1, "NUM_SYNC_DEVICES": 1, "USE_PRECISE_STATS": true, "WEIGHT_DECAY": 0.0}, "DATA": {"CROP_SIZE": 224, "DECODING_BACKEND": "pyav", "ENSEMBLE_METHOD": "sum", "INPUT_CHANNEL_NUM": [3, 3], "INV_UNIFORM_SAMPLE": false, "MEAN": [0.45, 0.45, 0.45], "MULTI_LABEL": false, "NUM_FRAMES": 32, "PATH_PREFIX": "", "PATH_TO_DATA_DIR": "", "RANDOM_FLIP": true, "REVERSE_INPUT_CHANNEL": false, "SAMPLING_RATE": 2, "STD": [0.225, 0.225, 0.225], "TARGET_FPS": 30, "TEST_CROP_SIZE": 256, "TRAIN_CROP_SIZE": 224, "TRAIN_JITTER_SCALES": [256, 320]}, "DATA_LOADER": {"ENABLE_MULTI_THREAD_DECODE": false, "NUM_WORKERS": 8, "PIN_MEMORY": true}, "DETECTION": {"ALIGNED": true, "ENABLE": false, "ROI_XFORM_RESOLUTION": 7, "SPATIAL_SCALE_FACTOR": 16}, "DIST_BACKEND": "nccl", "LOG_MODEL_INFO": true, "LOG_PERIOD": 10, "MODEL": {"ARCH": "mlp", "DROPOUT_RATE": 0.5, "FC_INIT_STD": 0.01, "HEAD_ACT": "softmax", "LOSS_FUNC": "cross_entropy", "MODEL_NAME": "SlowFast", "MULTI_PATHWAY_ARCH": ["slowfast"], "NUM_CLASSES": 400, "SINGLE_PATHWAY_ARCH": ["c2d", "i3d", "slow"]}, "MULTIGRID": {"BN_BASE_SIZE": 8, "DEFAULT_B": 0, "DEFAULT_S": 0, "DEFAULT_T": 0, "EPOCH_FACTOR": 1.5, "EVAL_FREQ": 3, "LONG_CYCLE": false, "LONG_CYCLE_FACTORS": [[0.25, 0.7071067811865476], [0.5, 0.7071067811865476], [0.5, 1], [1, 1]], "LONG_CYCLE_SAMPLING_RATE": 0, "SHORT_CYCLE": false, "SHORT_CYCLE_FACTORS": [0.5, 0.7071067811865476]}, "NONLOCAL": {"GROUP": [[1, 1], [1, 1], [1, 1], [1, 1]], "INSTANTIATION": "dot_product", "LOCATION": [[[], []], [[], []], [[], []], [[], []]], "POOL": [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]}, "NUM_GPUS": 8, "NUM_SHARDS": 1, "OUTPUT_DIR": ".", "RESNET": {"DEPTH": 50, "INPLACE_RELU": true, "NUM_BLOCK_TEMP_KERNEL": [[3, 3], [4, 4], [6, 6], [3, 3]], "NUM_GROUPS": 1, "SPATIAL_DILATIONS": [[1, 1], [1, 1], [1, 1], [1, 1]], "SPATIAL_STRIDES": [[1, 1], [2, 2], [2, 2], [2, 2]], "STRIDE_1X1": false, "TRANS_FUNC": "bottleneck_transform", "WIDTH_PER_GROUP": 64, "ZERO_INIT_FINAL_BN": true}, "RNG_SEED": 0, "SHARD_ID": 0, "SLOWFAST": {"ALPHA": 4, "BETA_INV": 8, "FUSION_CONV_CHANNEL_RATIO": 2, "FUSION_KERNEL_SZ": 7}, "SOLVER": {"BASE_LR": 0.1, "DAMPENING": 0.0, "GAMMA": 0.1, "LRS": [], "LR_POLICY": "cosine", "MAX_EPOCH": 196, "MOMENTUM": 0.9, "NESTEROV": true, "OPTIMIZING_METHOD": "sgd", "STEPS": [], "STEP_SIZE": 1, "WARMUP_EPOCHS": 34.0, "WARMUP_FACTOR": 0.1, "WARMUP_START_LR": 0.01, "WEIGHT_DECAY": 0.0001}, "TENSORBOARD": {"ENABLE": false, "LOG_DIR": ""}, "TEST": {"BATCH_SIZE": 64, "CHECKPOINT_FILE_PATH": "", "CHECKPOINT_TYPE": "pytorch", "DATASET": "kinetics", "ENABLE": true, "NUM_ENSEMBLE_VIEWS": 10, "NUM_SPATIAL_CROPS": 3}, "TRAIN": {"AUTO_RESUME": true, "BATCH_SIZE": 64, "CHECKPOINT_FILE_PATH": "./weights/SLOWFAST_CU_8x8_R50.pkl", "CHECKPOINT_INFLATE": false, "CHECKPOINT_PERIOD": 1, "CHECKPOINT_TYPE": "caffe2", "DATASET": "kinetics", "ENABLE": false, "EVAL_PERIOD": 10}, "mlp_hid_dim": 1024, "mlp_inp_dim": 512}, "tx_dec": {"activation_dropout": 0.0, "activation_fn": "relu", "adaptive_input": false, "adaptive_softmax_cutoff": null, "adaptive_softmax_dropout": 0, "attention_dropout": 0.0, "checkpoint_activations": false, "cross_self_attention": false, "decoder_attention_heads": 8, "decoder_embed_dim": 1024, "decoder_embed_path": null, "decoder_ffn_embed_dim": 2048, "decoder_input_dim": 512, "decoder_layerdrop": 0, "decoder_layers": 3, "decoder_layers_to_keep": null, "decoder_learned_pos": false, "decoder_normalize_before": false, "decoder_output_dim": 512, "dropout": 0.1, "encoder_attention_heads": 8, "encoder_embed_dim": 1024, "encoder_embed_path": null, "encoder_ffn_embed_dim": 2048, "encoder_layerdrop": 0, "encoder_layers": 3, "encoder_layers_to_keep": null, "encoder_learned_pos": false, "encoder_normalize_before": false, "layernorm_embedding": false, "max_source_positions": 1024, "max_target_positions": 1024, "merge_src_tgt_embed": false, "no_cross_attention": false, "no_scale_embedding": false, "no_token_positional_embeddings": false, "offload_activations": false, "quant_noise_pq": 0, "quant_noise_pq_block_size": 8, "quant_noise_scalar": 0, "share_all_embeddings": false, "share_decoder_input_output_embed": false, "tie_adaptive_weights": false}, "mdl_data_names": {"trn_data": "VsituDS", "val_data": "VsituDS", "trn_collator": "BatchCollator", "val_collator": "BatchCollator", "mdl_name": "VerbModel", "loss_name": "LossB", "eval_name": "EvalB", "opt_name": "Adam"}}

epochs  trn_loss  val_loss  val_Per_Ev_Top_1  val_Per_Ev_Top_5  val_recall_macro_1_th_9

1       5.1738    0.0000    0.3566            0.7481            0.0875                 
2       5.0277    0.0000    0.3917            0.7659            0.1200                 
3       5.0033    0.0000    0.3843            0.7560            0.1414                 
4       4.8795    0.0000    0.3992            0.7613            0.1467                 
5       4.8474    0.0000    0.4002            0.7655            0.1494                 
6       4.6644    0.0000    0.3851            0.7660            0.1517                 
7       4.7179    0.0000    0.3872            0.7544            0.1618                 
8       4.6624    0.0000    0.3866            0.7545            0.1566                 
9       4.4700    0.0000    0.3850            0.7494            0.1607                 
10      4.4352    0.0000    0.3909            0.7474            0.1611                 
11      4.4365    0.0000    0.3769            0.7396            0.1589                 
12      4.2482    0.0000    0.3749            0.7335            0.1627                 
13      4.2445    0.0000    0.3521            0.7172            0.1694                 
14      4.1019    0.0000    0.3495            0.7100            0.1687                 
15      4.0280    0.0000    0.3417            0.7023            0.1702                 
16      3.9428    0.0000    0.3477            0.6998            0.1722                 
17      3.7788    0.0000    0.3406            0.6895            0.1630                 
18      3.6944    0.0000    0.3254            0.6837            0.1649                 
19      3.6940    0.0000    0.3204            0.6618            0.1675                 
20      3.6228    0.0000    0.3139            0.6515            0.1669                 
epochs done 19. Exited due to exception False. Total time taken  2060.6643


epochs  val_loss  val_Per_Ev_Top_1  val_Per_Ev_Top_5  val_recall_macro_1_th_9
5       0.0000    0.4002            0.7655            0.1494                 
