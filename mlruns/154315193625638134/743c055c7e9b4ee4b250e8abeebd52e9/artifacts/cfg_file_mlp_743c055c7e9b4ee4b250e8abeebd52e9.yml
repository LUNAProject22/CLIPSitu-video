DIST_BACKEND: nccl
SHARD_ID: 0
cmd: ['/home/dhruv/Projects/VidSitu/main_dist.py', 'mlp', '--task_type', 'vb']
cmd_str: /home/dhruv/Projects/VidSitu/main_dist.py mlp --task_type vb
debug_mode: False
do_dist: False
do_dp: False
ds:
  trn_shuffle: True
  val_set_type: lb
  vsitu:
    arg_names:
      adir: ADir
      ag0: Arg0
      ag1: Arg1
      ag2: Arg2
      ag3: Arg3
      ag4: Arg4
      agol: AGol
      aloc: ALoc
      amnr: AMnr
      aprp: APrp
      ascn: AScn
      vb: Vb
    evrel_trimmed: True
    name: vid_situ
    num_ev: 5
    split_files_dir: ./vidsitu_data/vidsitu_annotations/split_files
    split_files_lb:
      test_evrel: ./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testevrel_lb.json
      test_srl: ./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testsrl_lb.json
      test_verb: ./vidsitu_data/vidsitu_annotations/split_files/vseg_split_testvb_lb.json
      train: ./vidsitu_data/vidsitu_annotations/split_files/vseg_split_train_lb.json
      valid: ./vidsitu_data/vidsitu_annotations/split_files/vseg_split_valid_lb.json
    video_frms_tdir: ./vidsitu_data/vsitu_frames/
    video_trimmed_dir: ./vidsitu_data/vsitu_video_trimmed_dir
    vinfo_files_lb:
      test_evrel: ./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testevrel_lb.json
      test_srl: ./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testsrl_lb.json
      test_verb: ./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_testvb_lb.json
      train: ./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_train_lb.json
      valid: ./vidsitu_data/vidsitu_annotations/vinfo_files/vinfo_valid_lb.json
    vocab_files:
      new_gpt2_vb_arg_vocab: ./vidsitu_data/vsitu_vocab/bpe_with_seps_vb_arg_vocab.pkl
      vb_arg_vocab: ./vidsitu_data/vsitu_meta/vsitu_vocab/vb_arg_vocab.pkl
      verb_id_vocab: ./vidsitu_data/vsitu_vocab/verb_id_vocab.pkl
    vsit_clip_frm_feats_dir: ./vidsitu_data/clip-vit-large-patch14-336
    vsit_frm_feats_dir: ./vidsitu_data/vsitu_vid_feats/i3d_nln_kpret_ep10_best_recall
    vsitu_ann_files_lb:
      test_evrel: ./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testevrel_lb.json
      test_srl: ./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testsrl_lb.json
      test_verb: ./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_testvb_lb.json
      train: ./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_train_lb.json
      valid: ./vidsitu_data/vidsitu_annotations/vseg_ann_files/vsann_valid_lb.json
    vsitu_frm_feats: ./vidsitu_data/vsitu_vid_feats/
expm:
  exp_name: vsitu_fin
  run_id: 743c055c7e9b4ee4b250e8abeebd52e9
  st_time: 2024-01-28 19:33:10
gen:
  beam_size: 1
  len_penalty: 1
  max_len_a: 0
  max_len_b: 200
  min_len: 0
  no_repeat_ngram_size: 0
  normalize_scores: True
  temperature: 1.0
  unk_penalty: 0
local_rank: 0
log:
  deb_it: 2
mdl:
  arg_mlp_hid_dim: 1024
  gpt2_mdl_name: gpt2-medium
  load_sf_pretrained: False
  mdl_name: mlp_sfpret_txed_vbarg
  rob_mdl_name: roberta-base
  sf_mdl_cfg_file: ./configs/vsitu_mdl_cfgs/Kinetics_c2_SLOWFAST_8x8_R50.yaml
  sf_mdl_name: slow_fast_nl_r50_8x8
  tx_dec_cfg_file: ./configs/vsitu_tx_cfgs/transformer.yaml
  tx_dec_mdl_name: transformer
  tx_dec_type: txdec
  tx_enc_type: old
  use_old_tok: False
mdl_data_names:
  eval_name: EvalB
  loss_name: LossB
  mdl_name: VerbModel
  opt_name: Adam
  trn_collator: BatchCollator
  trn_data: VsituDS
  val_collator: BatchCollator
  val_data: VsituDS
misc:
  tmp_path: ./tmp
num_gpus: 1
only_test: False
only_val: False
overfit_batch: False
run_final_val: True
sf_mdl:
  AVA:
    ANNOTATION_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
    BGR: False
    DETECTION_SCORE_THRESH: 0.9
    EXCLUSION_FILE: ava_val_excluded_timestamps_v2.2.csv
    FRAME_DIR: /mnt/fair-flash3-east/ava_trainval_frames.img/
    FRAME_LIST_DIR: /mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/
    FULL_TEST_ON_VAL: False
    GROUNDTRUTH_FILE: ava_val_v2.2.csv
    IMG_PROC_BACKEND: cv2
    LABEL_MAP_FILE: ava_action_list_v2.2_for_activitynet_2019.pbtxt
    TEST_FORCE_FLIP: False
    TEST_LISTS: ['val.csv']
    TEST_PREDICT_BOX_LISTS: ['ava_val_predicted_boxes.csv']
    TRAIN_GT_BOX_LISTS: ['ava_train_v2.2.csv']
    TRAIN_LISTS: ['train.csv']
    TRAIN_PCA_EIGVAL: [0.225, 0.224, 0.229]
    TRAIN_PCA_EIGVEC: [[-0.5675, 0.7192, 0.4009], [-0.5808, -0.0045, -0.814], [-0.5836, -0.6948, 0.4203]]
    TRAIN_PCA_JITTER_ONLY: True
    TRAIN_PREDICT_BOX_LISTS: []
    TRAIN_USE_COLOR_AUGMENTATION: False
  BENCHMARK:
    LOG_PERIOD: 100
    NUM_EPOCHS: 5
    SHUFFLE: True
  BN:
    EPSILON: 1e-05
    MOMENTUM: 0.1
    NORM_TYPE: batchnorm
    NUM_BATCHES_PRECISE: 200
    NUM_SPLITS: 1
    NUM_SYNC_DEVICES: 1
    USE_PRECISE_STATS: True
    WEIGHT_DECAY: 0.0
  DATA:
    CROP_SIZE: 224
    DECODING_BACKEND: pyav
    ENSEMBLE_METHOD: sum
    INPUT_CHANNEL_NUM: [3, 3]
    INV_UNIFORM_SAMPLE: False
    MEAN: [0.45, 0.45, 0.45]
    MULTI_LABEL: False
    NUM_FRAMES: 32
    PATH_PREFIX: ''
    PATH_TO_DATA_DIR: ''
    RANDOM_FLIP: True
    REVERSE_INPUT_CHANNEL: False
    SAMPLING_RATE: 2
    STD: [0.225, 0.225, 0.225]
    TARGET_FPS: 30
    TEST_CROP_SIZE: 256
    TRAIN_CROP_SIZE: 224
    TRAIN_JITTER_SCALES: [256, 320]
  DATA_LOADER:
    ENABLE_MULTI_THREAD_DECODE: False
    NUM_WORKERS: 8
    PIN_MEMORY: True
  DETECTION:
    ALIGNED: True
    ENABLE: False
    ROI_XFORM_RESOLUTION: 7
    SPATIAL_SCALE_FACTOR: 16
  DIST_BACKEND: nccl
  LOG_MODEL_INFO: True
  LOG_PERIOD: 10
  MODEL:
    ARCH: mlp
    DROPOUT_RATE: 0.5
    FC_INIT_STD: 0.01
    HEAD_ACT: softmax
    LOSS_FUNC: cross_entropy
    MODEL_NAME: SlowFast
    MULTI_PATHWAY_ARCH: ['slowfast']
    NUM_CLASSES: 400
    SINGLE_PATHWAY_ARCH: ['c2d', 'i3d', 'slow']
  MULTIGRID:
    BN_BASE_SIZE: 8
    DEFAULT_B: 0
    DEFAULT_S: 0
    DEFAULT_T: 0
    EPOCH_FACTOR: 1.5
    EVAL_FREQ: 3
    LONG_CYCLE: False
    LONG_CYCLE_FACTORS: [[0.25, 0.7071067811865476], [0.5, 0.7071067811865476], [0.5, 1], [1, 1]]
    LONG_CYCLE_SAMPLING_RATE: 0
    SHORT_CYCLE: False
    SHORT_CYCLE_FACTORS: [0.5, 0.7071067811865476]
  NONLOCAL:
    GROUP: [[1, 1], [1, 1], [1, 1], [1, 1]]
    INSTANTIATION: dot_product
    LOCATION: [[[], []], [[], []], [[], []], [[], []]]
    POOL: [[[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]], [[1, 2, 2], [1, 2, 2]]]
  NUM_GPUS: 8
  NUM_SHARDS: 1
  OUTPUT_DIR: .
  RESNET:
    DEPTH: 50
    INPLACE_RELU: True
    NUM_BLOCK_TEMP_KERNEL: [[3, 3], [4, 4], [6, 6], [3, 3]]
    NUM_GROUPS: 1
    SPATIAL_DILATIONS: [[1, 1], [1, 1], [1, 1], [1, 1]]
    SPATIAL_STRIDES: [[1, 1], [2, 2], [2, 2], [2, 2]]
    STRIDE_1X1: False
    TRANS_FUNC: bottleneck_transform
    WIDTH_PER_GROUP: 64
    ZERO_INIT_FINAL_BN: True
  RNG_SEED: 0
  SHARD_ID: 0
  SLOWFAST:
    ALPHA: 4
    BETA_INV: 8
    FUSION_CONV_CHANNEL_RATIO: 2
    FUSION_KERNEL_SZ: 7
  SOLVER:
    BASE_LR: 0.1
    DAMPENING: 0.0
    GAMMA: 0.1
    LRS: []
    LR_POLICY: cosine
    MAX_EPOCH: 196
    MOMENTUM: 0.9
    NESTEROV: True
    OPTIMIZING_METHOD: sgd
    STEPS: []
    STEP_SIZE: 1
    WARMUP_EPOCHS: 34.0
    WARMUP_FACTOR: 0.1
    WARMUP_START_LR: 0.01
    WEIGHT_DECAY: 0.0001
  TENSORBOARD:
    ENABLE: False
    LOG_DIR: ''
  TEST:
    BATCH_SIZE: 64
    CHECKPOINT_FILE_PATH: ''
    CHECKPOINT_TYPE: pytorch
    DATASET: kinetics
    ENABLE: True
    NUM_ENSEMBLE_VIEWS: 10
    NUM_SPATIAL_CROPS: 3
  TRAIN:
    AUTO_RESUME: True
    BATCH_SIZE: 64
    CHECKPOINT_FILE_PATH: ./weights/SLOWFAST_CU_8x8_R50.pkl
    CHECKPOINT_INFLATE: False
    CHECKPOINT_PERIOD: 1
    CHECKPOINT_TYPE: caffe2
    DATASET: kinetics
    ENABLE: False
    EVAL_PERIOD: 10
  mlp_hid_dim: 1024
  mlp_inp_dim: 768
task_type: vb
test_dl_name: test
train:
  bs: 32
  bsv: 16
  epochs: 20
  freeze_sfbase: False
  load_normally: True
  load_opt: True
  lr: 0.0001
  ns: 4
  nw: 4
  nwv: 4
  resume: False
  resume_path: ''
  save_mdl_epochs: False
  sfbase_pret_path: ''
  strict_load: True
  use_reduce_lr_plateau: False
  verbose: False
tx_dec:
  activation_dropout: 0.0
  activation_fn: relu
  adaptive_input: False
  adaptive_softmax_cutoff: None
  adaptive_softmax_dropout: 0
  attention_dropout: 0.0
  checkpoint_activations: False
  cross_self_attention: False
  decoder_attention_heads: 8
  decoder_embed_dim: 1024
  decoder_embed_path: None
  decoder_ffn_embed_dim: 2048
  decoder_input_dim: 512
  decoder_layerdrop: 0
  decoder_layers: 3
  decoder_layers_to_keep: None
  decoder_learned_pos: False
  decoder_normalize_before: False
  decoder_output_dim: 512
  dropout: 0.1
  encoder_attention_heads: 8
  encoder_embed_dim: 1024
  encoder_embed_path: None
  encoder_ffn_embed_dim: 2048
  encoder_layerdrop: 0
  encoder_layers: 3
  encoder_layers_to_keep: None
  encoder_learned_pos: False
  encoder_normalize_before: False
  layernorm_embedding: False
  max_source_positions: 1024
  max_target_positions: 1024
  merge_src_tgt_embed: False
  no_cross_attention: False
  no_scale_embedding: False
  no_token_positional_embeddings: False
  offload_activations: False
  quant_noise_pq: 0
  quant_noise_pq_block_size: 8
  quant_noise_scalar: 0
  share_all_embeddings: False
  share_decoder_input_output_embed: False
  tie_adaptive_weights: False
uid: mlp
val_dl_name: valid